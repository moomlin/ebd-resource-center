<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>情緒支援中心後台管理</title>
    <link rel="stylesheet" href="dashboard.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <div class="admin-layout">
      <!-- 左側欄 -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <h1>後台管理</h1>
          <p class="sidebar-subtitle">情緒支援資源中心</p>
        </div>

        <div class="sidebar-user">
          <span class="sidebar-user-label">登入帳號：</span>
          <span id="adminUserEmail" class="sidebar-user-email"></span>
        </div>

        <nav class="sidebar-menu">
          <button
            class="admin-menu-item active"
            data-section="fileAdminSection"
          >
            檔案與公告管理
          </button>
          <button
            class="admin-menu-item"
            data-section="pageTextAdminSection"
          >
            分頁文字管理
          </button>
          <button
            class="admin-menu-item"
            data-section="teamAdminSection"
          >
            團隊教師名單
          </button>
          <button
            class="admin-menu-item"
            data-section="leaveAdminSection"
          >
            教師請假系統
          </button>
          <button
            class="admin-menu-item"
            data-section="userApprovalSection"
          >
            使用者審核管理
          </button>
          <a
            href="https://drive.google.com/drive/folders/1LNlK4gYHPqaz6T5ZYC9b0VBsMHyf2xFK"
            target="_blank"
            rel="noopener noreferrer"
            class="admin-menu-link"
          >
            情支中心行政資料（雲端）
          </a>
          <a
            href="https://drive.google.com/drive/folders/11dwnAdddyxkaopA3ysXHVkC2SAcrfr-N"
            target="_blank"
            rel="noopener noreferrer"
            class="admin-menu-link"
          >
            情支中心個案資料（雲端）
          </a>
        </nav>

        <button id="logoutBtn" class="logout-btn">登出</button>
      </aside>

      <!-- 右側內容 -->
      <main class="main-content">
        <!-- 右上角歡迎與導航欄 -->
        <div class="top-nav-bar">
          <div class="top-nav-item">
            歡迎：<span id="topNavUserName"></span> 老師
            <button id="topNavBackToFrontBtn" class="top-nav-btn">回到首頁</button>
            <button id="topNavLogoutBtn" class="top-nav-btn logout-style">登出</button>
          </div>
        </div>

        <!-- 檔案與公告管理 -->
        <section
          id="fileAdminSection"
          class="admin-section"
        >
          <header class="section-header">
            <h2>檔案與公告管理</h2>
            <p>
              在這裡新增或調整「最新消息」、「計畫與表件」、「情支服務」、「其他資源」的檔案與公告資訊。
              前台會依照分類顯示成表格，老師可以從網站下載使用。
            </p>
          </header>

          <form id="fileForm" class="card">
            <input type="hidden" id="fileDocId" />

            <div class="form-row">
              <div class="form-col">
                <label for="fileCategory">主分類</label>
                <select id="fileCategory">
                  <option value="">請選擇</option>
                  <option value="最新消息">最新消息</option>
                  <option value="計畫與表件">計畫與表件</option>
                  <option value="情支服務">情支服務</option>
                  <option value="其他資源">其他資源</option>
                </select>
              </div>

              <div
                class="form-col form-col-full"
                id="fileServiceGroup"
              >
                <div class="form-col-half">
                  <label for="fileServiceLevel"
                    >情支層級（僅情支服務用）</label
                  >
                  <select id="fileServiceLevel">
                    <option value="">不分層級</option>
                    <option value="初級預防">初級預防</option>
                    <option value="次級預防">次級預防</option>
                    <option value="三級預防">三級預防</option>
                  </select>
                </div>
                <div class="form-col-half">
                  <label for="fileServiceType"
                    >情支類別（僅情支服務用）</label
                  >
                  <select id="fileServiceType">
                    <option value="">不分類別</option>
                    <option value="研習活動">研習活動</option>
                    <option value="增能學習資料">增能學習資料</option>
                    <option value="個案服務">個案服務</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="form-row">
              <label for="fileInfoTitle">公告內容 / 資訊標題</label>
              <input
                type="text"
                id="fileInfoTitle"
                placeholder="例：113學年度情支服務申請表公告"
              />
            </div>

            <div class="form-row">
              <div class="form-col-half">
                <label for="fileName">檔案名稱</label>
                <input
                  type="text"
                  id="fileName"
                  placeholder="例：情支服務申請表"
                />
              </div>
              <div class="form-col-half">
                <label for="fileType">檔案格式</label>
                <input
                  type="text"
                  id="fileType"
                  placeholder="例：PDF、DOCX、ODT"
                />
              </div>
            </div>

            <div class="form-row">
              <label for="fileUrl">檔案連結（雲端網址）</label>
              <input
                type="text"
                id="fileUrl"
                placeholder="請貼上 Google 雲端或學校系統的下載連結"
              />
            </div>

            <div class="form-row">
              <label for="fileNote">備註（選填）</label>
              <input
                type="text"
                id="fileNote"
                placeholder="例：僅限導師使用、已含家長同意書等"
              />
            </div>

            <div class="form-actions">
              <button type="submit" id="fileSaveBtn">
                建立 / 儲存公告
              </button>
              <button
                type="button"
                id="fileSearchBtn"
                class="btn-secondary"
              >
                查詢
              </button>
              <button
                type="button"
                id="fileReloadBtn"
                class="btn-secondary"
              >
                重新整理
              </button>
              <button
                type="button"
                id="fileClearBtn"
                class="btn-tertiary"
              >
                清除搜尋條件
              </button>
            </div>
          </form>

          <section class="card">
            <h3 class="card-title">已建立的資訊公告</h3>
            <table class="info-table" id="fileTable">
              <thead>
                <tr>
                  <th>上傳日期</th>
                  <th>主分類</th>
                  <th>公告內容</th>
                  <th>檔案名稱</th>
                  <th>備註</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="6" class="empty-text">
                    目前尚無任何檔案資訊。
                  </td>
                </tr>
              </tbody>
            </table>
          </section>
        </section>

        <!-- 分頁文字管理 -->
        <section
          id="pageTextAdminSection"
          class="admin-section"
          style="display: none"
        >
          <header class="section-header">
            <h2>分頁文字管理</h2>
            <p>用來管理前台各分頁的說明文字（例如團隊介紹、情支服務說明等）。</p>
          </header>

          <form id="pageTextForm" class="card">
            <div class="form-row">
              <label for="pageKey">選擇分頁</label>
              <select id="pageKey">
                <option value="">請選擇</option>
                <option value="news">最新消息</option>
                <option value="teamIntro">團隊介紹</option>
                <option value="plans">計畫與表件</option>
                <option value="services">情支服務</option>
                <option value="resources">其他資源</option>
              </select>
            </div>

            <div class="form-row">
              <label for="pageTextContent">分頁說明文字（會在前台顯示在標題下方）</label>
              <textarea
                id="pageTextContent"
                rows="8"
                placeholder="請輸入此分頁的說明文字，例如：服務對象、使用方式、注意事項等。"
              ></textarea>
            </div>

            <div class="form-actions">
              <button type="submit">儲存分頁文字</button>
            </div>
          </form>
        </section>

        <!-- 團隊教師名單 -->
        <section
          id="teamAdminSection"
          class="admin-section"
          style="display: none"
        >
          <header class="section-header">
            <h2>團隊教師名單</h2>
            <p>
              在這裡可以新增 / 編輯 / 刪除團隊成員，前台「團隊介紹」會自動更新。
            </p>
          </header>

          <form id="teamForm" class="card">
            <input type="hidden" id="teamDocId" />

            <div class="form-row">
              <div class="form-col-half">
                <label for="teamRoleGroup">角色群組（職務）</label>
                <select id="teamRoleGroup">
                  <option value="召集人">召集人</option>
                  <option value="專業督導">專業督導</option>
                  <option value="副召集人">副召集人</option>
                  <option value="專業教師">專業教師</option>
                  <option value="執行秘書">執行秘書</option>
                </select>
              </div>
              <div class="form-col-half">
                <label for="teamName">姓名</label>
                <select id="teamName" required>
                  <option value="">請選擇已審核通過的教師</option>
                </select>
              </div>
            </div>

            <div class="form-row">
              <div class="form-col-half">
                <label for="teamJobTitle">職稱</label>
                <input
                  type="text"
                  id="teamJobTitle"
                  placeholder="例：校長、教師、教授"
                />
              </div>
              <div class="form-col-half">
                <label for="teamRoleTitle">角色稱謂（顯示名稱）</label>
                <input
                  type="text"
                  id="teamRoleTitle"
                  placeholder="例：召集人、專業督導、專業教師1"
                />
              </div>
            </div>

            <div class="form-row">
              <div class="form-col-half">
                <label for="teamAvatarType">照片 / Avatar 顯示方式</label>
                <select id="teamAvatarType">
                  <option value="photo">使用照片網址</option>
                  <option value="avatar">使用 Avatar</option>
                </select>
              </div>
              <div class="form-col-half">
                <label for="teamPhotoUrl">照片網址（若使用 Avatar 可留白）</label>
                <input
                  type="text"
                  id="teamPhotoUrl"
                  placeholder="請貼上團隊成員照片的網址"
                />
              </div>
            </div>

            <div class="form-actions">
              <button type="submit">新增 / 儲存成員</button>
              <button
                type="button"
                id="resetTeamFormBtn"
                class="btn-tertiary"
              >
                清除欄位
              </button>
            </div>
          </form>

          <section class="card">
            <h3 class="card-title">目前成員列表</h3>
            <table class="info-table" id="teamTable">
              <thead>
                <tr>
                  <th>角色群組</th>
                  <th>姓名</th>
                  <th>職稱</th>
                  <th>角色稱謂</th>
                  <th>顯示方式</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="6" class="empty-text">
                    尚未建立任何成員資料。
                  </td>
                </tr>
              </tbody>
            </table>
          </section>
        </section>

        <!-- 教師請假系統 -->
        <section
          id="leaveAdminSection"
          class="admin-section"
          style="display: none"
        >
          <header class="section-header">
            <h2>教師請假系統</h2>
            <p>
              提供教師登記請假紀錄，並統計各假別時數。包含清單檢視與月曆檢視兩種模式。
            </p>
          </header>

          <div class="subtabs card">
            <button
              class="subtab-button active"
              data-subtab="leaveStatsPanel"
            >
              請假時數統計
            </button>
            <button
              class="subtab-button"
              data-subtab="leaveFormPanel"
            >
              請假登記
            </button>
            <button
              class="subtab-button"
              data-subtab="leaveSummaryReportPanel"
            >
              請假資訊統整表
            </button>
          </div>

          <!-- 請假統計 -->
          <section
            id="leaveStatsPanel"
            class="card subtab-panel"
          >
            <h3 class="card-title">查詢條件</h3>

            <form id="leaveStatsForm">
              <div class="form-row">
                <div class="form-col">
                  <label for="statsTeacherNameSelect"
                    >教師姓名（選填）</label
                  >
                  <select id="statsTeacherNameSelect">
                    <option value="">全部教師</option>
                  </select>
                </div>

                <div class="form-col">
                  <label for="statsStartDate">開始日期</label>
                  <input type="date" id="statsStartDate" />
                </div>

                <div class="form-col">
                  <label for="statsEndDate">結束日期</label>
                  <input type="date" id="statsEndDate" />
                </div>

                <div class="form-col">
                  <label for="statsLeaveType">假別</label>
                  <select id="statsLeaveType">
                    <option value="">全部假別</option>
                    <option value="事假">事假</option>
                    <option value="病假">病假</option>
                    <option value="公假">公假</option>
                    <option value="家庭照顧假">家庭照顧假</option>
                    <option value="歲時祭儀假">歲時祭儀假</option>
                    <option value="心理調適假">心理調適假</option>
                  </select>
                </div>
              </div>

              <div class="form-row">
                <div class="form-col-half">
                  <label for="statsViewMode">檢視模式</label>
                  <select id="statsViewMode">
                    <option value="list">清單檢視</option>
                    <option value="calendar">月曆檢視</option>
                  </select>
                </div>

                <div class="form-col-half align-right">
                  <div class="form-actions right-actions">
                    <button type="submit" id="statsSearchBtn">
                      查詢
                    </button>
                    <button
                      type="button"
                      id="statsResetBtn"
                      class="btn-tertiary"
                    >
                      清除搜尋條件
                    </button>
                  </div>
                </div>
              </div>
            </form>

            <!-- 清單檢視 -->
            <div id="leaveListView">
              <h3 class="card-title">請假清單檢視</h3>
              <table class="info-table" id="leaveStatsTable">
                <thead>
                  <tr>
                    <th>請假日期</th>
                    <th>教師</th>
                    <th>假別</th>
                    <th>時間範圍</th>
                    <th>請假時數</th>
                    <th>職務代理人</th>
                    <th>操作</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="7" class="empty-text">
                      目前查詢條件下沒有請假紀錄。
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- 月曆檢視 -->
            <div
              id="leaveCalendarView"
              style="display: none"
            >
              <div class="calendar-header">
                <button
                  type="button"
                  id="prevMonthBtn"
                  class="btn-tertiary"
                >
                  ◀ 上一個月
                </button>
                <span id="calendarMonthLabel"></span>
                <button
                  type="button"
                  id="nextMonthBtn"
                  class="btn-tertiary"
                >
                  下一個月 ▶
                </button>
              </div>
              <div
                id="leaveCalendarContainer"
                class="calendar-grid"
              ></div>
            </div>
          </section>

          <!-- 請假登記 -->
          <section
            id="leaveFormPanel"
            class="card subtab-panel"
            style="display: none"
          >
            <h3 class="card-title">請假登記</h3>

            <form id="leaveForm">
              <div class="form-row">
                <div class="form-col-half">
                  <label for="leaveTeacherName">請假人姓名 <span style="color: red;">*</span></label>
                  <select id="leaveTeacherName" required>
                    <option value="">請選擇教師</option>
                  </select>
                </div>
                <div class="form-col-half">
                  <label for="leaveType">假別 <span style="color: red;">*</span></label>
                  <select id="leaveType" required>
                    <option value="">請選擇假別</option>
                    <option value="事假">事假</option>
                    <option value="病假">病假</option>
                    <option value="公假">公假</option>
                    <option value="家庭照顧假">家庭照顧假</option>
                    <option value="歲時祭儀假">歲時祭儀假</option>
                    <option value="心理調適假">心理調適假</option>
                  </select>
                </div>
              </div>

              <div class="form-row">
                <div class="form-col">
                  <label for="leaveDate">請假日期（若請假多天，請分天填寫） <span style="color: red;">*</span></label>
                  <input type="date" id="leaveDate" required />
                </div>
              </div>

              <div class="form-row">
                <div class="form-col-half">
                  <label>時間範圍 <span style="color: red;">*</span></label>
                  <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                    <div style="flex: 0 1 45%;">
                      <label style="font-size: 11px; color: #666;">開始</label>
                      <div style="display: flex; gap: 4px;">
                        <select id="leaveStartHour" style="flex: 1; font-size: 12px;" required>
                          <option value="">時</option>
                          <option value="01">01</option>
                          <option value="02">02</option>
                          <option value="03">03</option>
                          <option value="04">04</option>
                          <option value="05">05</option>
                          <option value="06">06</option>
                          <option value="07">07</option>
                          <option value="08">08</option>
                          <option value="09">09</option>
                          <option value="10">10</option>
                          <option value="11">11</option>
                          <option value="12">12</option>
                        </select>
                        <select id="leaveStartMinute" style="flex: 1; font-size: 12px;" required>
                          <option value="">分</option>
                          <option value="00">00</option>
                          <option value="15">15</option>
                          <option value="30">30</option>
                          <option value="45">45</option>
                        </select>
                        <select id="leaveStartPeriod" style="flex: 0.8; font-size: 12px;" required>
                          <option value="">上/下</option>
                          <option value="AM">上</option>
                          <option value="PM">下</option>
                        </select>
                      </div>
                    </div>

                    <div style="flex: 0 1 45%;">
                      <label style="font-size: 11px; color: #666;">結束</label>
                      <div style="display: flex; gap: 4px;">
                        <select id="leaveEndHour" style="flex: 1; font-size: 12px;" required>
                          <option value="">時</option>
                          <option value="01">01</option>
                          <option value="02">02</option>
                          <option value="03">03</option>
                          <option value="04">04</option>
                          <option value="05">05</option>
                          <option value="06">06</option>
                          <option value="07">07</option>
                          <option value="08">08</option>
                          <option value="09">09</option>
                          <option value="10">10</option>
                          <option value="11">11</option>
                          <option value="12">12</option>
                        </select>
                        <select id="leaveEndMinute" style="flex: 1; font-size: 12px;" required>
                          <option value="">分</option>
                          <option value="00">00</option>
                          <option value="15">15</option>
                          <option value="30">30</option>
                          <option value="45">45</option>
                        </select>
                        <select id="leaveEndPeriod" style="flex: 0.8; font-size: 12px;" required>
                          <option value="">上/下</option>
                          <option value="AM">上</option>
                          <option value="PM">下</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
                <div class="form-col-half">
                  <label for="leaveHours">請假時數（最小單位為一小時） <span style="color: red;">*</span></label>
                  <input 
                    type="text" 
                    id="leaveHours" 
                    readonly 
                    placeholder="自動計算"
                  />
                </div>
              </div>

              <div class="form-row">
                <div class="form-col">
                  <label for="leaveAgent">職務代理人 <span style="color: red;">*</span></label>
                  <input type="text" id="leaveAgent" required />
                </div>
              </div>

              <div class="form-row">
                <div class="form-col">
                  <label for="leaveProofUrl">相關請假證明（雲端網址）</label>
                  <input type="text" id="leaveProofUrl" placeholder="選填" />
                </div>
              </div>

              <div class="form-row">
                <label for="leaveReason">請假事由（可簡要說明）</label>
                <textarea
                  id="leaveReason"
                  rows="3"
                  placeholder="選填：例：陪同家人就醫、參加研習活動等"
                ></textarea>
              </div>

              <div class="form-actions">
                <button type="submit">儲存請假紀錄</button>
              </div>
            </form>

            <h3 class="card-title">最近新增紀錄</h3>
            <table class="info-table" id="recentLeaveTable">
              <thead>
                <tr>
                  <th>請假日期</th>
                  <th>教師</th>
                  <th>假別</th>
                  <th>時間範圍</th>
                  <th>請假時數</th>
                  <th>職務代理人</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="7" class="empty-text">
                    尚無請假紀錄。
                  </td>
                </tr>
              </tbody>
            </table>
          </section>

          <!-- 請假資訊統整表 -->
          <section
            id="leaveSummaryReportPanel"
            class="card subtab-panel"
            style="display: none"
          >
            <h3 class="card-title">查詢條件</h3>

            <form id="leaveSummaryReportForm" class="card">
              <div class="form-row">
                <div class="form-col-half">
                  <label for="reportTeacherNameSelect">教師姓名</label>
                  <select id="reportTeacherNameSelect" required>
                    <option value="">請選擇教師</option>
                  </select>
                </div>
                <div class="form-col-half align-right">
                  <div class="form-actions right-actions">
                    <button type="submit" id="generateReportBtn">
                      查詢
                    </button>
                  </div>
                </div>
              </div>
            </form>

            <!-- 報表容器 -->
            <div id="leaveSummaryReportContainer" style="display: none; margin-top: 40px; padding: 30px; background-color: #fafafa; border: 1px solid #e0d4c8;">
              
              <!-- 報表標題 -->
              <div style="text-align: center; margin-bottom: 30px;">
                <h2 style="font-size: 18px; font-weight: bold; margin: 0 0 15px 0;">特殊教育中心請假資訊統整表</h2>
              </div>

              <!-- 教師與學校資訊 -->
              <div id="reportTeacherInfo" style="display: flex; gap: 60px; margin-bottom: 30px; font-size: 14px;">
                <div><span style="font-weight: bold;">教師：</span><span id="reportTeacherName"></span></div>
                <div><span style="font-weight: bold;">任教學校：</span><span id="reportTeacherSchool"></span></div>
              </div>

              <!-- 本學年請假資訊總表 -->
              <div style="margin-bottom: 20px;">
                <p style="font-weight: bold; margin: 0 0 10px 0;">本學年請假資訊總表（依各假別時數分列）</p>
                <table class="info-table" id="leaveSummaryTable" style="background-color: white;">
                  <thead>
                    <tr>
                      <th>假別</th>
                      <th>時數</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td colspan="2" class="empty-text">
                        無統計資料。
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>

            </div>
          </section>
        </section>

        <!-- 使用者審核管理 -->
        <section
          id="userApprovalSection"
          class="admin-section"
          style="display: none"
        >
          <header class="section-header">
            <h2>使用者審核管理</h2>
            <p>
              審核與管理新用戶的註冊申請。可批准、拒絕或刪除用戶帳號。
            </p>
          </header>

          <div class="subtabs card">
            <button
              class="subtab-button active"
              data-subtab="pendingUsersPanel"
            >
              待審核用戶
            </button>
            <button
              class="subtab-button"
              data-subtab="approvedUsersPanel"
            >
              已批准用戶
            </button>
            <button
              class="subtab-button"
              data-subtab="rejectedUsersPanel"
            >
              已拒絕用戶
            </button>
          </div>

          <!-- 待審核用戶 -->
          <section
            id="pendingUsersPanel"
            class="card subtab-panel"
          >
            <h3 class="card-title">待審核用戶清單</h3>
            <table class="info-table" id="pendingUsersTable">
              <thead>
                <tr>
                  <th>姓名</th>
                  <th>電子郵件</th>
                  <th>生日</th>
                  <th>學校</th>
                  <th>職位</th>
                  <th>註冊方式</th>
                  <th>申請日期</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="8" class="empty-text">
                    目前沒有待審核的用戶。
                  </td>
                </tr>
              </tbody>
            </table>
          </section>

          <!-- 已批准用戶 -->
          <section
            id="approvedUsersPanel"
            class="card subtab-panel"
            style="display: none"
          >
            <h3 class="card-title">已批准用戶清單</h3>
            <table class="info-table" id="approvedUsersTable">
              <thead>
                <tr>
                  <th>姓名</th>
                  <th>電子郵件</th>
                  <th>生日</th>
                  <th>學校</th>
                  <th>職位</th>
                  <th>註冊方式</th>
                  <th>申請日期</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="8" class="empty-text">
                    目前沒有已批准的用戶。
                  </td>
                </tr>
              </tbody>
            </table>
          </section>

          <!-- 已拒絕用戶 -->
          <section
            id="rejectedUsersPanel"
            class="card subtab-panel"
            style="display: none"
          >
            <h3 class="card-title">已拒絕用戶清單</h3>
            <table class="info-table" id="rejectedUsersTable">
              <thead>
                <tr>
                  <th>姓名</th>
                  <th>電子郵件</th>
                  <th>生日</th>
                  <th>學校</th>
                  <th>職位</th>
                  <th>註冊方式</th>
                  <th>申請日期</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="8" class="empty-text">
                    目前沒有已拒絕的用戶。
                  </td>
                </tr>
              </tbody>
            </table>
          </section>
        </section>
      </main>
    </div>

    <!-- 檔案 / 公告 編輯 Modal -->
    <div id="fileEditModal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-dialog">
        <h3>編輯檔案 / 公告</h3>

        <form id="fileEditForm">
          <input type="hidden" id="fileEditDocId" />

          <div class="form-row">
            <label for="fileEditCategory">主分類</label>
            <select id="fileEditCategory">
              <option value="最新消息">最新消息</option>
              <option value="計畫與表件">計畫與表件</option>
              <option value="情支服務">情支服務</option>
              <option value="其他資源">其他資源</option>
            </select>
          </div>

          <div class="form-row">
            <label for="fileEditInfoTitle">公告內容 / 賊訊標題</label>
            <input type="text" id="fileEditInfoTitle" />
          </div>

          <div class="form-row">
            <label for="fileEditFileName">檔案名稱</label>
            <input type="text" id="fileEditFileName" />
          </div>

          <div class="form-row">
            <label for="fileEditFileType">檔案格式</label>
            <input type="text" id="fileEditFileType" />
          </div>

          <div class="form-row">
            <label for="fileEditUrl">檔案連結（雲端網址）</label>
            <input type="text" id="fileEditUrl" />
          </div>

          <div class="form-row">
            <label for="fileEditNote">備註</label>
            <textarea id="fileEditNote" rows="2"></textarea>
          </div>

          <div class="form-actions modal-actions">
            <button type="submit">儲存變更</button>
            <button
              type="button"
              id="fileEditCancelBtn"
              class="btn-tertiary"
            >
              取消
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- 團隊教師 編輯 Modal（之後要用，可先保留） -->
    <div id="teamEditModal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-dialog">
        <h3>編輯團隊成員</h3>
        <form id="teamEditForm">
          <input type="hidden" id="teamEditDocId" />

          <div class="form-row">
            <label for="teamEditRoleGroup">角色群組</label>
            <select id="teamEditRoleGroup">
              <option value="召集人">召集人</option>
              <option value="專業督導">專業督導</option>
              <option value="副召集人">副召集人</option>
              <option value="專業教師">專業教師</option>
              <option value="執行秘書">執行秘書</option>
            </select>
          </div>

          <div class="form-row">
            <label for="teamEditName">姓名</label>
            <input type="text" id="teamEditName" />
          </div>

          <div class="form-row">
            <label for="teamEditJobTitle">職稱</label>
            <input type="text" id="teamEditJobTitle" />
          </div>

          <div class="form-row">
            <label for="teamEditRoleTitle">角色稱謂（顯示名稱）</label>
            <input type="text" id="teamEditRoleTitle" />
          </div>

          <div class="form-row">
            <label for="teamEditAvatarType">顯示方式</label>
            <select id="teamEditAvatarType">
              <option value="photo">使用照片網址</option>
              <option value="avatar">使用 Avatar</option>
            </select>
          </div>

          <div class="form-row">
            <label for="teamEditPhotoUrl">照片網址</label>
            <input type="text" id="teamEditPhotoUrl" />
          </div>

          <div class="form-actions modal-actions">
            <button type="submit">儲存變更</button>
            <button
              type="button"
              id="teamEditCancelBtn"
              class="btn-tertiary"
            >
              取消
            </button>
          </div>
        </form>
      </div>

    </main>
    </div>

    <script type="module" src="dashboard.js"></script>
  </body>
</html>